var App=App||{Config:{},Util:{},Controllers:{}};App.Config.Disqus={disqus_developer:document.domain==="127.0.0.1",disqus_shortname:"USERNAME"},App.Config.Analytics={account:"UA-XXXXXXX-XX"},App.Config.GooglePlus={___gcfg:{lang:"en-GB"}},App.Util.inherits=function(a,b){function c(){}c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a},App.Util.insertScript=function(a,b){if(document.getElementById(a))return;this.head||(this.head=document.getElementsByTagName("head")[0]);var c=document.createElement("script");c.id=a,c.src=b,c.async=!0,this.head.appendChild(c,this.insert)},App.Util.globalizeConfig=function(a){for(var b in a)window[b]=a[b]},App.Controllers.Home=function(){App.Controllers.Page.apply(this,arguments)},App.Util.inherits(App.Controllers.Home,App.Controllers.Page),App.Controllers.Post=function(){App.Controllers.Page.apply(this,arguments),this.bindEvents(),this.showGooglePlusButton(),this.showTweetButton(),window.location.hash.indexOf("disqus_thread")!==-1&&this.showDisqusComments()},App.Util.inherits(App.Controllers.Post,App.Controllers.Page),App.Controllers.Post.prototype.initPlugins=function(){App.Controllers.Page.prototype.initPlugins.apply(this,arguments),prettyPrint()},App.Controllers.Post.prototype.bindEvents=function(){$("#view-comments").on("click",$.proxy(this,"onViewCommentsClick"))},App.Controllers.Post.prototype.showTweetButton=function(){App.Util.insertScript("twitter-wjs","//platform.twitter.com/widgets.js")},App.Controllers.Post.prototype.showGooglePlusButton=function(){App.Util.globalizeConfig(App.Config.GooglePlus),App.Util.insertScript("google-plus","https://apis.google.com/js/plusone.js")},App.Controllers.Post.prototype.onViewCommentsClick=function(a){a.preventDefault(),a.target.disabled=!0,a.target.innerHTML=a.target.innerHTML.replace(/(.*>)[\s\S]+$/,"$1 Loading..."),a.target.className+=" disabled",this.showDisqusComments()},App.Controllers.Post.prototype.showDisqusComments=function(){window.disqus_config=this.disqusConfig,App.Util.globalizeConfig(App.Config.Disqus),App.Util.insertScript("disqus-comments","http://"+App.Config.Disqus.disqus_shortname+".disqus.com/embed.js")},App.Controllers.Post.prototype.disqusConfig=function(){this.callbacks.onReady.push(App.Controllers.Post.prototype.onDisqusReady)},App.Controllers.Post.prototype.onDisqusReady=function(){$("html,body").animate({scrollTop:$("#disqus_thread").offset().top-70},800)},App.Controllers.Page=function(){App.Controllers.Base.apply(this,arguments),this.initTracking(),this.initPlugins()},App.Util.inherits(App.Controllers.Page,App.Controllers.Base),App.Controllers.Page.prototype.initTracking=function(){if(!this.config.trackPage)return;window._gaq=[],window._gaq.push(["_setAccount",App.Config.Analytics.account]),window._gaq.push(["_trackPageview"]);var a=("https:"===document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";App.Util.insertScript("google-analytics",a)},App.Controllers.Page.prototype.initPlugins=function(){},App.Controllers.Base=function(a){this.config=a},App.Controllers.Blog=function(){App.Controllers.Page.apply(this,arguments),this.getElements(),this.bindEvents(),this.showDisqusCommentsCount(),this.showTeets()},App.Util.inherits(App.Controllers.Blog,App.Controllers.Page),App.Controllers.Blog.prototype.initPlugins=function(){App.Controllers.Page.prototype.initPlugins.apply(this,arguments),prettyPrint()},App.Controllers.Blog.prototype.getElements=function(){this.posts=$(".post"),this.expandButton=$("#posts-expand"),this.collapseButton=$("#posts-collapse"),this.sidebar=$("#sidebar"),this.navbar=$("#navbar"),this.tweets=$("#latest-tweets")},App.Controllers.Blog.prototype.bindEvents=function(){this.collapseButton.on("click",$.proxy(this,"collapsePosts")),this.expandButton.on("click",$.proxy(this,"expandPosts")),$(window).on("resize",$.proxy(this,"onWindowResize")).trigger("resize")},App.Controllers.Blog.prototype.onWindowResize=function(){clearTimeout(this.timer),this.timer=setTimeout($.proxy(this,"repositionSidebar"),40)},App.Controllers.Blog.prototype.repositionSidebar=function(){this.sidebar.css({position:"static",width:"auto",height:"auto",left:"auto",top:"auto"});var a=$(window).height(),b=$(window).width(),c=this.sidebar.outerHeight(),d=this.navbar.outerHeight()+30,e=b<=979,f=a<c+d;if(e||f)return;this.sidebar.css({width:this.sidebar.outerWidth(),height:c,left:this.sidebar.offset().left,top:this.sidebar.offset().top,position:"fixed"})},App.Controllers.Blog.prototype.expandPosts=function(){this.posts.find(".body").show()},App.Controllers.Blog.prototype.collapsePosts=function(){this.posts.find(".body").hide()},App.Controllers.Blog.prototype.showDisqusCommentsCount=function(){App.Util.globalizeConfig(App.Config.Disqus),App.Util.insertScript("disqus-comments-count","http://"+App.Config.Disqus.disqus_shortname+".disqus.com/count.js")},App.Controllers.Blog.prototype.showTeets=function(){var a="badsyntax",b=["https://api.twitter.com/1/statuses/user_timeline.json?include_entities=true","include_rts=true","screen_name="+a,"count=5","callback=?"].join("&");$.getJSON(b,$.proxy(function(b){if(!b)return;var c=_.template('<li><a href="<%= url %>"><%= text %></a></li>'),d="";_.each(b,function(b){b.url="https://twitter.com/"+a+"/status/"+b.id_str,d+=c(b)}),this.tweets.find("ul").append(d).end().fadeIn()},this))},App.Controllers.Contact=function(){App.Controllers.Page.apply(this,arguments),this.bindEvents(),this.focusForm()},App.Util.inherits(App.Controllers.Contact,App.Controllers.Page),App.Controllers.Contact.prototype.initPlugins=function(){App.Controllers.Page.prototype.initPlugins.apply(this,arguments),$(".social-icons").tooltip({selector:"a[rel=tooltip]",placement:"bottom"})},App.Controllers.Contact.prototype.bindEvents=function(){$(".alert").on("click",".close",$.proxy(this,"onAlertsCloseButtonClick"))},App.Controllers.Contact.prototype.onAlertsCloseButtonClick=function(a){$(a.currentTarget).parent().hide()},App.Controllers.Contact.prototype.focusForm=function(){$(".contact-form").find(":text,textarea").each(this.focusField)},App.Controllers.Contact.prototype.focusField=function(){var a=$.trim(this.value)==="",b=$(this).parents(".control-group").hasClass("error");if(a||b)return this.focus(),!1};